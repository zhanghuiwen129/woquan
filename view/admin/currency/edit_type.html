{extend name="admin/layout" /}

{block name="title"}<title>ç¼–è¾‘è´§å¸ç±»å‹ - åå°ç®¡ç†ç³»ç»Ÿ</title>{/block}

{block name="content"}
<div class="mb-4">
    <h2 class="text-lg font-semibold text-modern-dark">ç¼–è¾‘è´§å¸/ç§¯åˆ†ç±»å‹</h2>
    <p class="text-modern-gray text-sm mt-1">
        <i class="fas fa-info-circle mr-1"></i>
        ä¿®æ”¹ç°æœ‰çš„è´§å¸æˆ–ç§¯åˆ†ç±»å‹
    </p>
</div>

<!-- æ“ä½œæŒ‰é’® -->
<div class="card rounded-lg p-4 mb-6">
    <a href="/admin/currency" class="px-4 py-2 bg-modern-gray text-white text-sm rounded-md hover:bg-modern-darkGray transition-colors flex items-center gap-2">
        <i class="fas fa-arrow-left"></i>
        <span>è¿”å›åˆ—è¡¨</span>
    </a>
</div>

<!-- ç¼–è¾‘è¡¨å• -->
<div class="card rounded-lg p-6 max-w-3xl">
    <form id="currencyForm">
        <input type="hidden" name="id" value="{$currencyType.id}">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <!-- åŸºæœ¬ä¿¡æ¯ -->
            <div>
                <h3 class="text-lg font-medium text-modern-dark mb-4">åŸºæœ¬ä¿¡æ¯</h3>
                <div class="mb-4">
                    <label class="block text-sm text-modern-gray mb-2">
                        è´§å¸åç§° <span class="text-modern-danger">*</span>
                    </label>
                    <input type="text" name="name" value="{$currencyType.name}" placeholder="å¦‚ï¼šé‡‘å¸ã€ç§¯åˆ†ã€é’»çŸ³" 
                           class="w-full px-4 py-2 bg-modern-light border border-modern-lightGray rounded-md focus:outline-none focus:border-modern-primary focus:ring-1 focus:ring-modern-primary" required>
                </div>
                <div class="mb-4">
                    <label class="block text-sm text-modern-gray mb-2">
                        è´§å¸ç¬¦å· <span class="text-modern-danger">*</span>
                    </label>
                    <input type="text" name="symbol" value="{$currencyType.symbol}" placeholder="å¦‚ï¼šğŸ’°ã€ğŸª™ã€ğŸ’" 
                           class="w-full px-4 py-2 bg-modern-light border border-modern-lightGray rounded-md focus:outline-none focus:border-modern-primary focus:ring-1 focus:ring-modern-primary" required>
                </div>
                <div class="mb-4">
                    <label class="block text-sm text-modern-gray mb-2">æè¿°</label>
                    <textarea name="description" rows="3" placeholder="è¯·è¾“å…¥è´§å¸æè¿°" 
                              class="w-full px-4 py-2 bg-modern-light border border-modern-lightGray rounded-md focus:outline-none focus:border-modern-primary focus:ring-1 focus:ring-modern-primary resize-none">{$currencyType.description}</textarea>
                </div>
            </div>

            <!-- è®¾ç½® -->
            <div>
                <h3 class="text-lg font-medium text-modern-dark mb-4">è®¾ç½®</h3>
                <div class="mb-4">
                    <label class="block text-sm text-modern-gray mb-2">æ’åº</label>
                    <input type="number" name="sort" value="{$currencyType.sort}" placeholder="0"
                           class="w-full px-4 py-2 bg-modern-light border border-modern-lightGray rounded-md focus:outline-none focus:border-modern-primary focus:ring-1 focus:ring-modern-primary">
                    <p class="text-xs text-modern-gray mt-2">æ•°å­—è¶Šå°è¶Šé å‰</p>
                </div>
                <div class="mb-4">
                    <label class="block text-sm text-modern-gray mb-2">çŠ¶æ€</label>
                    <select name="status" 
                            class="w-full px-4 py-2 bg-modern-light border border-modern-lightGray rounded-md focus:outline-none focus:border-modern-primary focus:ring-1 focus:ring-modern-primary">
                        <option value="1" {$currencyType.status == 1 ? 'selected' : ''}>å¯ç”¨</option>
                        <option value="0" {$currencyType.status == 0 ? 'selected' : ''}>ç¦ç”¨</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-sm text-modern-gray mb-2">ä¸»è¦è´§å¸</label>
                    <div class="flex items-center gap-3">
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" name="is_primary" value="1" {$currencyType.is_primary ? 'checked' : ''}
                                   class="w-4 h-4 rounded border-modern-lightGray text-modern-primary focus:ring-modern-primary">
                            <span class="text-sm text-modern-dark">è®¾ç½®ä¸ºä¸»è¦è´§å¸</span>
                        </label>
                    </div>
                    <p class="text-xs text-modern-gray mt-2">ç³»ç»Ÿä¸­åªèƒ½æœ‰ä¸€ä¸ªä¸»è¦è´§å¸ï¼Œè®¾ç½®åä¼šè‡ªåŠ¨å–æ¶ˆå…¶ä»–è´§å¸çš„ä¸»è¦è´§å¸çŠ¶æ€</p>
                </div>
            </div>
        </div>

        <!-- æ“ä½œæŒ‰é’® -->
        <div class="flex justify-end gap-4 pt-4 border-t border-modern-lightGray">
            <a href="/admin/currency" class="px-5 py-2 bg-modern-lightGray text-modern-gray rounded-md hover:bg-gray-300 transition-colors flex items-center gap-2">
                <i class="fas fa-arrow-left"></i>
                <span>è¿”å›åˆ—è¡¨</span>
            </a>
            <button type="submit" class="px-5 py-2 bg-modern-primary text-white rounded-md hover:bg-modern-secondary transition-colors shadow-modern flex items-center gap-2">
                <i class="fas fa-save"></i>
                <span>ä¿å­˜ä¿®æ”¹</span>
            </button>
        </div>
    </form>
</div>

<!-- JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script>
$('#currencyForm').submit(function(e) {
    e.preventDefault();
    
    var data = $(this).serialize();
    
    $.ajax({
        url: '/admin/currency/updateType',
        type: 'POST',
        data: data,
        dataType: 'json',
        beforeSend: function() {
            $('button[type="submit"]').attr('disabled', true).html('<i class="fas fa-spinner fa-spin mr-2"></i>ä¿å­˜ä¸­...');
        },
        success: function(res) {
            if (res.code == 200) {
                alert('æ›´æ–°æˆåŠŸï¼');
                window.location.href = '/admin/currency';
            } else {
                alert('æ›´æ–°å¤±è´¥ï¼š' + res.msg);
            }
        },
        error: function() {
            alert('ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•ï¼');
        },
        complete: function() {
            $('button[type="submit"]').attr('disabled', false).html('<i class="fas fa-save mr-2"></i>ä¿å­˜ä¿®æ”¹');
        }
    });
});
</script>
{/block}
