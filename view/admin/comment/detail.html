<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>评论详情 - 后台管理</title>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/fontawesome/latest/css/all.min.css">
    <style>
        body {
            background-color: #f7fafc;
        }
        .sidebar {
            width: 250px;
        }
        .inline-emoji {
            width: 16px !important;
            height: 16px !important;
            vertical-align: middle;
            display: inline-block;
        }
    </style>
</head>
<body class="flex h-screen overflow-hidden">
    <!-- 侧边栏 -->
    <div class="sidebar bg-gray-800 text-white p-6 flex flex-col">
        <div class="flex items-center mb-8">
            <i class="fas fa-crown text-yellow-400 text-2xl mr-2"></i>
            <span class="text-xl font-bold">后台管理</span>
        </div>
        <div class="flex-1">
            <nav>
                <ul>
                    <li class="mb-2">
                        <a href="/admin/dashboard" class="flex items-center p-3 rounded hover:bg-gray-700 transition">
                            <i class="fas fa-home mr-3"></i>
                            <span>仪表盘</span>
                        </a>
                    </li>
                    <li class="mb-2">
                        <a href="/admin/user" class="flex items-center p-3 rounded hover:bg-gray-700 transition">
                            <i class="fas fa-users mr-3"></i>
                            <span>用户管理</span>
                        </a>
                    </li>
                    <li class="mb-2">
                        <a href="/admin/dynamic" class="flex items-center p-3 rounded hover:bg-gray-700 transition">
                            <i class="fas fa-comments mr-3"></i>
                            <span>动态管理</span>
                        </a>
                    </li>
                    <li class="mb-2">
                        <a href="/admin/currency" class="flex items-center p-3 rounded hover:bg-gray-700 transition">
                            <i class="fas fa-coins mr-3"></i>
                            <span>货币/积分管理</span>
                        </a>
                    </li>
                    <li class="mb-2">
                        <a href="/admin/vip" class="flex items-center p-3 rounded hover:bg-gray-700 transition">
                            <i class="fas fa-star mr-3"></i>
                            <span>VIP会员管理</span>
                        </a>
                    </li>
                    <li class="mb-2">
                        <a href="/admin/topic" class="flex items-center p-3 rounded hover:bg-gray-700 transition">
                            <i class="fas fa-hashtag mr-3"></i>
                            <span>话题管理</span>
                        </a>
                    </li>
                    <li class="mb-2">
                        <a href="/admin/comment" class="flex items-center p-3 rounded bg-gray-700 transition">
                            <i class="fas fa-comment-dots mr-3"></i>
                            <span>评论管理</span>
                        </a>
                    </li>
                    <li class="mb-2">
                        <a href="/admin/announcement" class="flex items-center p-3 rounded hover:bg-gray-700 transition">
                            <i class="fas fa-bullhorn mr-3"></i>
                            <span>系统公告管理</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
        <div class="mt-8">
            <a href="/admin/logout" class="flex items-center p-3 rounded bg-red-600 hover:bg-red-700 transition">
                <i class="fas fa-sign-out-alt mr-3"></i>
                <span>退出登录</span>
            </a>
        </div>
    </div>
    
    <!-- 主内容区 -->
    <div class="flex-1 flex flex-col overflow-hidden">
        <!-- 顶部导航栏 -->
        <div class="bg-white shadow-sm border-b border-gray-200 px-6 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center">
                    <h1 class="text-xl font-semibold text-gray-800">评论详情</h1>
                    <a href="/admin/comment" class="ml-4 text-blue-500 hover:text-blue-700 flex items-center">
                        <i class="fas fa-arrow-left mr-1"></i> 返回列表
                    </a>
                </div>
            </div>
        </div>
        
        <!-- 内容区域 -->
        <div class="flex-1 overflow-y-auto p-6">
            <!-- 主评论信息 -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <div class="flex items-start">
                    <?php if ($comment['avatar']): ?>
                    <img src="<?php echo $comment['avatar'] ?: '/images/avatars/default-avatar.png'; ?>" alt="头像" class="w-12 h-12 rounded-full mr-4">
                    <?php else: ?>
                    <div class="w-12 h-12 bg-gray-200 rounded-full mr-4 flex items-center justify-center">
                        <i class="fas fa-user text-2xl"></i>
                    </div>
                    <?php endif; ?>
                    <div class="flex-1">
                        <div class="flex justify-between items-start">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900"><?php echo $comment['nickname']; ?></h3>
                                <div class="text-sm text-gray-500 mt-1">
                                    <span class="mr-4">UID: <?php echo $comment['user_id']; ?></span>
                                    <span class="mr-4">评论ID: <?php echo $comment['id']; ?></span>
                                    <span class="mr-4">动态ID: <?php echo $comment['moment_id']; ?></span>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-<?php echo $comment['status'] ? 'green' : 'red'; ?>-100 text-<?php echo $comment['status'] ? 'green' : 'red'; ?>-800">
                                    <?php echo $comment['status'] ? '正常' : '禁用'; ?>
                                </span>
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-<?php echo $comment['is_top'] ? 'yellow' : 'gray'; ?>-100 text-<?php echo $comment['is_top'] ? 'yellow' : 'gray'; ?>-800">
                                    <?php echo $comment['is_top'] ? '置顶' : '普通'; ?>
                                </span>
                            </div>
                        </div>
                        <div class="mt-3 text-gray-700 whitespace-pre-wrap">
                            <?php echo $comment['content']; ?>
                        </div>
                        <div class="mt-3 flex items-center space-x-4 text-sm text-gray-500">
                            <div class="flex items-center">
                                <i class="fas fa-heart mr-1 text-red-500"></i>
                                <span><?php echo $comment['like_count'] ?? 0; ?>赞</span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-comment mr-1"></i>
                                <span><?php echo $comment['reply_count'] ?? 0; ?>回复</span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-clock mr-1"></i>
                                <span><?php echo date('Y-m-d H:i:s', $comment['create_time']); ?></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 回复列表 -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-lg font-semibold text-gray-900 mb-4">
                    <i class="fas fa-reply-all mr-2"></i>
                    回复列表
                    <span class="ml-2 text-sm font-normal text-gray-500">(共 <?php echo count($replies); ?> 条)</span>
                </h2>
                
                <?php if (empty($replies)): ?>
                <div class="text-center py-8 text-gray-500">
                    <i class="fas fa-comment-slash text-4xl mb-2"></i>
                    <p>暂无回复</p>
                </div>
                <?php else: ?>
                <div class="space-y-4">
                    <?php foreach($replies as $reply): ?>
                    <div class="border-l-4 border-gray-200 pl-4 py-2">
                        <div class="flex items-start">
                            <?php if ($reply['avatar']): ?>
                            <img src="<?php echo $reply['avatar'] ?: 'http://127.0.0.1/static/images/default-avatar.png'; ?>" alt="头像" class="w-8 h-8 rounded-full mr-3">
                            <?php else: ?>
                            <div class="w-8 h-8 bg-gray-200 rounded-full mr-3 flex items-center justify-center">
                                <i class="fas fa-user"></i>
                            </div>
                            <?php endif; ?>
                            <div class="flex-1">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h4 class="font-medium text-gray-900 text-sm"><?php echo $reply['nickname']; ?></h4>
                                        <div class="text-xs text-gray-500 mt-1">
                                            <span class="mr-3">UID: <?php echo $reply['user_id']; ?></span>
                                            <span class="mr-3">回复ID: <?php echo $reply['id']; ?></span>
                                            <?php if ($reply['reply_to_user_id']): ?>
                                            <span class="text-blue-500">回复: UID <?php echo $reply['reply_to_user_id']; ?></span>
                                            <?php endif; ?>
                                        </div>
                                    </div>
                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-<?php echo $reply['status'] ? 'green' : 'red'; ?>-100 text-<?php echo $reply['status'] ? 'green' : 'red'; ?>-800">
                                        <?php echo $reply['status'] ? '正常' : '禁用'; ?>
                                    </span>
                                </div>
                                <div class="mt-2 text-sm text-gray-700 whitespace-pre-wrap">
                                    <?php echo $reply['content']; ?>
                                </div>
                                <div class="mt-2 flex items-center space-x-3 text-xs text-gray-500">
                                    <div class="flex items-center">
                                        <i class="fas fa-heart mr-1 text-red-500"></i>
                                        <span><?php echo $reply['like_count'] ?? 0; ?></span>
                                    </div>
                                    <div class="flex items-center">
                                        <i class="fas fa-clock mr-1"></i>
                                        <span><?php echo date('Y-m-d H:i:s', $reply['create_time']); ?></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <?php endforeach; ?>
                </div>
                <?php endif; ?>
            </div>
        </div>
    </div>
</body>
</html>
